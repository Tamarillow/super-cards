---
title: "Tamalow Card Game"
output: html_notebook
runtime: shiny
---

This is an R Markdown Notebook that works through the steps to create a digital version of the card game Tamalow.  

The first section of code creates an array that represents a fifty two card deck. 

```{r echo = FALSE, message = FALSE}
library(shiny)
library(DT)

deck <- array(NA,52)
playernames <- list("Jo", "Dave", "Will", "Arkie")
houses <- list("Spades","Diamonds","Clubs","Hearts")
card <- list("Ace of ", "Two of ", "Three of ", "Four of ", "Five of ", "Six of ", "Seven of ", "Eight of ", "Nine of ", "Ten of ", "Jack of ", "Queen of ", "King of ")

t <- 0
for (i in 1:4){
  for(j in 1:13){
    t <- t+1
    deck[t] <- paste0(card[j],houses[i])
  }
}

deck2 <- deck

```

The next section randomly deals cards between four named players.



```{r echo = FALSE}
 
  players <- data.frame("Jo"=1:4,"Dave"=1:4,"Will"=1:4,"Arkie"=1:4)
   
for (p in 1:4){
  randomnum <- floor(runif (1, min = 1, max = length(deck)))
  players$Arkie[p] <- deck[randomnum]
  deck <- deck[-randomnum]
  
  randomnum <- floor(runif (1, min = 1, max = length(deck)))
  players$Dave[p] <- deck[randomnum]
  deck <- deck[-randomnum]
  
  randomnum <- floor(runif (1, min = 1, max = length(deck)))
  players$Will[p] <- deck[randomnum]
  deck <- deck[-randomnum]
  
  randomnum <- floor(runif (1, min = 1, max = length(deck)))
  players$Jo[p] <- deck[randomnum]
  deck <- deck[-randomnum]
}

  randomnum <- floor(runif (1, min = 1, max = length(deck)))
  revealed <- deck[randomnum]
  deck <- deck[-randomnum]
  
  tamallow <- list(players = players, deck = deck, revealed = revealed, playernames = playernames)

 
```



Enable players to select the cards that they want to play

```{r echo = FALSE}


checkboxGroupInput("JocheckGroup", label = h3("Jo's Cards"), 
    choices = list("Card 1" = 1, "Card 2" = 2, "Card 3" = 3, "Card 4" = 4),
    selected = NULL)

checkboxGroupInput("ArkiecheckGroup", label = h3("Arkie's Cards"), 
    choices = list("Card 1" = 1, "Card 2" = 2, "Card 3" = 3, "Card 4" = 4),
    selected = NULL)

checkboxGroupInput("WillcheckGroup", label = h3("Will's Cards"), 
    choices = list("Card 1" = 1, "Card 2" = 2, "Card 3" = 3, "Card 4" = 4),
    selected = NULL)

checkboxGroupInput("DavecheckGroup", label = h3("Dave's Cards"), 
    choices = list("Card 1" = 1, "Card 2" = 2, "Card 3" = 3, "Card 4" = 4),
    selected = NULL)
```

Using an "End Turn" button to activate next turn and define whose go is next

```{r echo = FALSE}
players <- list(newplayer=playernames[length(playernames)], nextplayerid=length(playernames))

actionButton("turnend", "End Turn")

nextplayer <- eventReactive(input$turnend, {
  
  #if(input$turnend<1){nextplayerid <- nextplayerid+1}else {nextplayerid <- players$nextplayerid + 1 }
  players$nextplayerid <- players$nextplayerid + 1
  
  if (players$nextplayerid>length(tamallow$playernames)){
    players$nextplayerid <- 1
  }
  
 players$newplayer <- playernames[as.numeric(players$nextplayerid)]
  
  players
})

```



A series of buttons to run the different plays

```{r echo = FALSE}

actionButton("deal", "Swap")

playerss <- eventReactive(input$deal, {

  pippy <- length(tamallow$reveal)
  deckcard <- tamallow$reveal[pippy]
  playercard <- tamallow$players$Dave[as.numeric(input$DavecheckGroup)]
  tamallow$reveal[pippy] <- playercard
  tamallow$players$Dave[as.numeric(input$DavecheckGroup)] <- deckcard
  tamallow

})

```

This section creates the viewing output 

```{r echo = FALSE}

renderDataTable({
  if(input$deal==0){
  tamallow$players} else{tamallow<-playerss()
  tamallow$players}
   })
 
 renderText({
   
   if(input$deal==0){
      
     tamallow$reveal} else{tamallow<-playerss()
  tamallow$reveal}
})
 
 
renderText({
 length(tamallow$deck)
})

renderPrint({
  
 players <<- nextplayer()
  players$newplayer[[1]]
})

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

